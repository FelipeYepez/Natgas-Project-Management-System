<%- include('includes/openHTML.ejs'); %>
<%- include('includes/navbarIteracion.ejs'); %>

<main>
    <div class="container">
        <div class="row">
            <div class="col s12 ">
                <div class="center-align">
                    <canvas id="myChart"></canvas>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col s4 m4 l4">
                <div class="card">
                    <h2 class="card-title flow-text">Inicio:</h2>
                    <div class="card-content">
                        <p><strong><%= iteracion.fecha_inicio_YMD %></strong></p>
                    </div>
                </div>
            </div>
            <div class="col s4 m4 l4">
                <div class="card">
                    <h2 class="card-title flow-text">Fin:</h2>
                    <div class="card-content">
                        <p><strong><%= iteracion.fecha_fin_YMD %><strong></p>
                    </div>
                </div>
            </div>
            <div class="col s4 m4 l4">
                <div class="card">
                    <h2 class="card-title flow-text">Horas Planeadas:</h2>
                    <div class="card-content">
                        <strong><p><%=horas_planeadas%></p><strong>
                    </div>
                </div>
            </div>
        </div>


        <div class="row">
            <div class="col s6 m6 l6">
                <div class="card">
                    <h2 class="card-title flow-text">Información del proyecto:</h2>
                    <div class="card-content">
                        <p>Días Totales: <span><%=dias_totales%></span></p>
                        <p>Velocidad Deseada: <span><%=velocidad_deseada%></span></p><br>
                        <p>Valor Planeado: <span><%=velocidad_deseada%></span></p>
                        <p>Valor Ganado: <span>11.12</span></p>
                    </div>
                </div>
            </div>
            <div class="col s6 m6 l6">
                <div class="card">
                    <h2 class="card-title flow-text">Información
                        del proyecto:</h2>
                    <div class="card-content">
                        <p>Diferencia Progreso: <span>-4.4</span></p><br>
                            <p>Total Tareas: <span>108</span></p>
                            <p>Tareas Completadas: <span>96</span></p>
                            <p>Tareas Pendientes: <span>0</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col s12 offset-s2" id="tabla_avance">
            <table class="highlight">
                <thead>
                    <tr>
                        <th>Fecha</th>
                        <th class="center-align">Valor Ganado
                            (VG)</th>
                        <th class="center-align">Costo Real (CR)</th>
                        <th class="center-align">Valor Planeado
                            Acumulado (VPA)</th>
                        <th class="center-align">Valor Ganado
                            Acumulado (VGA)</th>
                        <th class="center-align">Costo Real
                            Acumulado (CRA)</th>
                    </tr>
                </thead>

                <tbody>
                    <tr>
                        <td>10/15/2020</td>
                        <td>11.1</td>
                        <td>14.6</td>
                        <td>15.5</td>
                        <td>11.1</td>
                        <td>14.6</td>
                    </tr>
                    <tr>
                        <td>10/16/2020</td>
                        <td>14.3</td>
                        <td>4.3</td>
                        <td>31.1</td>
                        <td>25.4</td>
                        <td>18.9</td>
                    </tr>
                    <tr>
                        <td>10/17/2020</td>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>31.1</td>
                        <td>25.4</td>
                        <td>18.9</td>
                    </tr>
                    <tr>
                        <td>10/18/2020</td>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>31.1</td>
                        <td>25.4</td>
                        <td>18.9</td>
                    </tr>
                    <tr>
                        <td>10/19/2020</td>
                        <td>17.7</td>
                        <td>46.6</td>
                        <td>43.2</td>
                        <td>37.2</td>
                        <td>5.9</td>
                    </tr>
                    <tr>
                        <td>10/20/2020</td>
                        <td>12.9</td>
                        <td>27.0</td>
                        <td>62.1</td>
                        <td>56.1</td>
                        <td>64.2</td>
                    </tr>
                    <tr>
                        <td>10/21/2020</td>
                        <td>7.9</td>
                        <td>12.9</td>
                        <td>77.6</td>
                        <td>64.0</td>
                        <td>77.1</td>
                    </tr>
                    <tr>
                        <td>10/22/2020</td>
                        <td>49.0</td>
                        <td>21.4</td>
                        <td>93.2</td>
                        <td>113.0</td>
                        <td>98.5</td>
                    </tr>
                    <tr>
                        <td>10/22/2020</td>
                        <td>4.9</td>
                        <td>9.0</td>
                        <td>93.2</td>
                        <td>108.7</td>
                        <td>117.9</td>
                    </tr>
                    <tr>
                        <td>10/22/2020</td>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>93.2</td>
                        <td>108.7</td>
                        <td>117.9</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</main>

<script>
    let entrega_real = [];
    let valor_ganado_diario = [];
    let costo_real_diario = [];
    let valor_ganado_acumulado = [];
    let costo_real_acumulado = [];

    "<% for(let i = 0; i < costos.length; i++){ %>"
            entrega_real.push("<%= costos[i].entrega_real %>");
            valor_ganado_diario.push("<%= costos[i].valor_ganado_diario %>");
            costo_real_diario.push("<%= costos[i].costo_real_diario %>");
            "<% if(i > 0){ %>"
                valor_ganado_acumulado.push((valor_ganado_acumulado["<%= i-1 %>"] + parseFloat("<%= costos[i].valor_ganado_diario %>")).toFixed(2));
                costo_real_acumulado.push((costo_real_acumulado["<%= i-1 %>"] + parseFloat("<%= costos[i].costo_real_diario %>")).toFixed(2));
            "<%} else{ %>"
                valor_ganado_acumulado.push(parseFloat("<%= costos[i].valor_ganado_diario %>"));
                costo_real_acumulado.push(parseFloat("<%= costos[i].costo_real_diario %>"));
            "<% } %>"
    
    "<% } %>"

    var ctx = document.getElementById('myChart').getContext('2d');
    var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'line',

    // The data for our dataset
    data: {
        labels: entrega_real,
        datasets: [{
            fill: false,
            //borderDash: [5, 5],
            label: 'Valor Ganado (VG)',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: valor_ganado_diario
        },
        {
            fill: false,
            //borderDash: [5, 5],
            label: 'Costo Real (CR)',
            backgroundColor: 'rgb(0, 300, 132)',
            borderColor: 'rgb(0, 300, 132)',
            data: costo_real_diario
        },
        {
            fill: false,
            //borderDash: [5, 5],
            label: 'Valor Ganado Acumulado (VGA)',
            backgroundColor: 'rgb(54, 162, 235)',
            borderColor: 'rgb(54, 162, 235)',
            data: valor_ganado_acumulado
        },
        {
            fill: false,
            //borderDash: [5, 5],
            label: 'Costo Real Acumulado (CRA)',
            backgroundColor: 'rgb(255, 205, 86)',
            borderColor: 'rgb(255, 205, 86)',
            data: costo_real_acumulado
        },]
    },

    // Configuration options go here
    options: {
        elements:{
            line:{
                tension:0
            }
        },
        responsive:true
    }

});


    </script>

<%- include('includes/closeHTML.ejs'); %>