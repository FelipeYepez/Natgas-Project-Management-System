<%- include('includes/openHTML.ejs'); %>
<%- include('includes/navbarProyecto.ejs'); %>
<main>
<div>

    <div class="row center-align">
        <div class="col s6 offset-s3">
            <h2>Fases del proyecto</h2>
        </div>
    </div>
    
    <div id="fases" class="">
        <% for (let fase_tarea = 0; fase_tarea < lista_tareas.length; fase_tarea++) { %>
            <%
                if(fase_tarea === 0 || lista_tareas[fase_tarea].nombre_fase !== lista_tareas[fase_tarea - 1].nombre_fase){
            %>
            <div id="fase" class="center-align">
                <div id="titulo-fase">
                    <span class=""> <%= lista_tareas[fase_tarea].nombre_fase %>: </span>
                </div>
                <div>
            <% } %>
                    <div id="tarea-en-fase">
                        <div class="in-line"> <%= lista_tareas[fase_tarea].nombre_practica_trabajo %> </div>
                    </div>
            <%
                if(fase_tarea === lista_tareas.length - 1 || lista_tareas[fase_tarea].nombre_fase !== lista_tareas[fase_tarea + 1].nombre_fase){
            %>
                </div>

                <form action="fases-proyecto" method="POST">
                    <div class="valign-wrapper">
                        <input type="hidden" name= "id_fase" value ="<%= lista_tareas[fase_tarea].id_fase %>">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                        <div class="center-align">
                            <button name = "action" value= "registrar-tarea" type="submit" class="boton_añadir"><i class="material-icons">add</i></button>
                        </div>
                        <div id="agregar-tarea" class="center-align">
                            <input placeholder="Nueva Tarea" id="añadir_nombre_tarea" name="añadir_nombre_tarea" type="text" required>
                        </div>
                    </div>
                </form>
            </div>
            <% } %>
        <% } %>

        <div id="fase-agregar" class="center-align">
            <form action="fases-proyecto" method="POST">
                <div class="valign-wrapper">
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    <div class="center-align">
                        <button name="action" value = "registrar-fase" type="submit" class="btn-floating cyan pulse boton_añadir"><i class="material-icons">add</i></button>
                    </div>
                    <div id="agregar-fase" class="center-align">
                        <input placeholder="Añadir Fase" id="añadir_nombre_fase" name="añadir_nombre_fase" type="text" required>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</main>


<%- include('includes/closeHTML.ejs'); %>